pipeline {
    agent { label'jenkins-agent' }
    tools {
        jdk 'Java17'
        maven 'Maven3'
}
stages {
    stage("cleanup workspace"){
          steps {
          cleanWs()
          }
}
  stage("checkout from scm"){
          steps {
              git branch: 'main', credentialsId: 'github', url: 'https://github.com/himani0323/registration-app.git'
          }
  }
  stage("build app"){
      steps {
        sh "mvn clean package"
      }
  }
   stage("test"){
       steps {
            sh "mvn test"
      }
  }
   stage("sonarqube analysis"){
      steps{
      script{
      withSonarQubeEnv(credentialId: 'jenkins-sonarqube-token'){
      sh "mvn sonar:sonar"
}
}
}
}
        
}

}

   
 
